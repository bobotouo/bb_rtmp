# 主流平台推流标准配置

## 竖屏推流配置（抖音、TikTok、视频号、快手等）

### 1. 标准分辨率（9:16 比例）

| 规格 | 分辨率 (宽 × 高) | 适用场景 | 推荐码率@30fps |
|------|-----------------|---------|---------------|
| **竖屏 720p** | `720 × 1280` | 网络较差或画质要求一般 | 2-3 Mbps |
| **竖屏 1080p** ⭐ | `1080 × 1920` | 主流标准配置（推荐） | 4-5 Mbps |
| **竖屏 2K** | `1440 × 2560` | 超高清直播 | 6-8 Mbps |

### 2. 编码参数

- **视频编码**: H.264 (AVC)
- **音频编码**: AAC-LC, 44100Hz, Mono/Stereo
- **帧率**: 30fps (日常) / 60fps (高动态场景)
- **GOP (关键帧间隔)**: **2 秒** (通用标准)
- **码率模式**: VBR (可变码率)

### 3. 码率建议

#### 1080p (1080 × 1920)
- **30fps**: 4 Mbps (推荐)
- **60fps**: 6 Mbps (推荐)

#### 720p (720 × 1280)
- **30fps**: 2.5 Mbps
- **60fps**: 4 Mbps

---

## 横屏推流配置（YouTube、B站、斗鱼等）

### 1. 标准分辨率（16:9 比例）

| 规格 | 分辨率 (宽 × 高) | 适用场景 | 推荐码率@30fps |
|------|-----------------|---------|---------------|
| **横屏 720p** | `1280 × 720` | 网络较差或画质要求一般 | 2-3 Mbps |
| **横屏 1080p** ⭐ | `1920 × 1080` | 主流标准配置（推荐） | 4-5 Mbps |
| **横屏 2K** | `2560 × 1440` | 超高清直播 | 6-8 Mbps |

---

## 插件实现说明

### VideoEncoder.kt
```kotlin
// GOP 设置（2 秒关键帧间隔）
format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, 2)
```

### 示例应用 (main.dart)
- **默认配置**: 竖屏 1080p (1080 × 1920), 4 Mbps, 30fps
- **动态分辨率**: 根据竖屏/横屏模式自动显示合适的分辨率选项
- **自动切换**: 切换方向时自动交换宽高

---

## 关键注意事项

1. **竖屏推流必须使用竖屏分辨率** (宽 < 高)，不能用横屏分辨率旋转
2. **GOP 2秒**是各大平台的通用标准，降低延迟且兼容性好
3. **码率**要匹配像素总量：1080p 的像素点数量是一样的，无论横竖屏
4. **VBR 模式**优于 CBR，能在保证质量的同时节省带宽

---

## 平台兼容性测试清单

- [x] 抖音
- [x] TikTok  
- [x] 视频号
- [x] 快手
- [x] YouTube Shorts
- [x] B站
- [x] 斗鱼
- [x] 虎牙

---

**生成日期**: 2026-01-07

